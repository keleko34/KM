var CreateKM=function(){function k(k,p){function c(){var a,b=c.childModules(),g=Object.keys(b),e;for(a=0;a<g.length;a+=1)e=b[g[a]],void 0!==e&&e.apply(this,arguments)}var A=function(){return function(){function a(w){var b=a.isConstructor(),c=a.isFunction(),d=a.value(),e=a.isModuleScoped(),g=a.module(),f,h;f=a["type"+r](w);if(void 0===w||c||b)return c||b?b?(g=Array.prototype.slice.call(arguments),g.unshift(0),new (d.bind.apply(d,g))):e?d.apply(g,arguments):d.apply(d,arguments):d;if(f.isValid&&l)for(d=
a.propertyName(),b=a.sharedModules(),c=Object.keys(b),e={stopPropagation:function(){this._stopPropagation=!0},value:w,propertyName:d,_stopPropagation:!1,changeOrigin:g},e.stopPropagation.bind(e),a.value(f.value),f=0;f<c.length&&!e._stopPropagation;f+=1)void 0!==b[c[f]]&&(h=b[c[f]][d],h.isModuleScoped()?h.onChange().call(h.module(),e):h.onChange().call(h.onChange(),e));return g}var b="",c,e,h,d=!1,f=!1,z=!1,k=!0,l=!0,m=function(){},n,x={},p=!1,q=!0,y={},r="string",u="string number object boolean function float array class".split(" "),
t=function(){};a.propertyName=function(a){if(void 0===a)return b;b=a.toString();return this};a.value=function(a){if(void 0===a)return c;c=a;return this};a.module=function(a){if(void 0===a)return e;e=a;return this};a.moduleName=function(a){if(void 0===a)return h;h=a.toString();return this};a.isPrivate=function(a){if(void 0===a)return d;d=!!a;return this};a.isFunction=function(a){if(void 0===a)return f;f=!!a;return this};a.configurable=function(a){if(void 0===a)return z;z=!!a;return this};a.enumerable=
function(a){if(void 0===a)return k;k=!!a;return this};a.writable=function(a){if(void 0===a)return l;l=!!a;return this};a.onChange=function(a){if(void 0===a)return m;m="function"===typeof a?a:function(){};return this};a.loadedFrom=function(a){if(void 0===a)return n;n=a;return this};a.sharedModules=function(a,b){if(void 0===a)return x;if(void 0===b)return x=a,this;x[a]=b;return this};a.isConstructor=function(a){if(void 0===a)return p;p=!!a;return this};a.isModuleScoped=function(a){if(void 0===a)return q;
q=!!a;return this};a.type=function(b){if(void 0===b)return r;r=-1<u.indexOf(b)?v:r;return a};a.typeClass=function(b){if(void 0===b)return t;t="function"===typeof b?b:t;return a};a.prototype=function(b,c){if(void 0===b)return y;if(void 0===c)return y=b,a.value().prototype=b,this;y[b.toString()]=c;a.value().prototype[b.toString()]=c;return this};a.typestring=function(a){return{isValid:"string"===typeof a||"[Object object]"!==a.toString(),value:a.toString()}};a.typenumber=function(a){return{isValid:"number"===
typeof a||!isNaN(parseInt(a,10)),value:parseInt(a,10)}};a.typeobject=function(a){return{isValid:"object"===typeof a&&a.constructor.toString()===Object.toString(),value:a}};a.typeboolean=function(a){return{isValid:"boolean"===typeof a||!0,value:!!a}};a.typefunction=function(a){return{isValid:"function"===typeof a,value:a}};a.typefloat=function(a){return{isValid:"number"===typeof a||!isNaN(parseFloat(a)),value:parseFloat(a)}};a.typearray=function(a){return{isValid:"object"===typeof a&&a.constructor.toString()===
Array.toString(),value:a}};a.typeclass=function(a){return{isValid:a.toString()===t.toString(),value:a}};a.typepath=function(a){return{isValid:"string"===typeof a&&(0===a.indexOf("/")||1===a.indexOf(":")),value:a}};return a}}(),q="",u="",l={},m={},n={};c.setModuleName=function(a){if(void 0===a)return q;q=a;return c};c.setModule=function(a){if(void 0===a)return u;u=a;var b={};b.moduleName=c.setModuleName;b.parentModules=c.parentModules;b.createGetSetFunction=c.createGetSetFunction;Object.defineProperty(a,
"_ModuleLoader",{value:b,writable:!1,enumerable:!1,configurable:!1});return c};c.parentModules=function(a,b){if(void 0===a)return l;if(void 0===b)return l=a,c;l[a]=b;return c};c.childModules=function(a,b){if(void 0===a)return m;if(void 0===b)return m=a,c;m[a]=b;return c};c.setLoadGroup=function(a,b){if(void 0===a)return n;if(void 0===b)return n=a,c;b.constructor===Object&&(b=Object.keys(b).map(function(a,c){return b[a]}));n[a]=b.constructor===Array?b.splice(0):[];return c};c.convertToOOP=function(a){var b=
Object.keys(a),c,e,h={};for(c=0;c<b.length;c+=1)e=a[b[c]],"function"===typeof e&&(h[b[c]]=e());return h};c.createGetSetFunction=function(a){a.module="object"!==typeof a.module?c.setModule():a.module;a.moduleName="string"!==typeof a.moduleName?a.module._ModuleLoader.moduleName():a.moduleName;var b=A();b.module(a.module);b.moduleName(a.moduleName);b.propertyName(a.propertyName);b.value(a.value);b.isPrivate(a.isPrivate);b.isFunction(a.isFunction);b.writable(a.writable);b.configurable(a.configurable);
b.enumerable(a.enumerable);b.onChange(a.onChange);b.loadedFrom(a.loadedFrom);b.sharedModules(a.sharedModules);b.sharedModules(a.moduleName,a.module);b.isConstructor(a.isConstructor);b.isModuleScoped(a.isModuleScoped);b.type(a.type);b.typeClass(a.typeClass);b.isConstructor()&&b.prototype(a.prototype);Object.defineProperty(b.module(),b.propertyName(),{get:function(){return b},set:function(a){b.writable()&&b(a)},configurable:!0,enumerable:b.enumerable()});return c};c.loadProperty=function(a,b,g){a[g].sharedModules(b._ModuleLoader.moduleName(),
b);var e=c.convertToOOP(a[g]),h,d;e.module=void 0;e.moduleName=void 0;e.onChange=void 0;e.loadedFrom=a._ModuleLoader.moduleName();b._ModuleLoader.createGetSetFunction(e);a=b[g];b=a.sharedModules();e=Object.keys(b);for(h=0;h<e.length;h+=1)void 0!==b[e[h]]&&(d=b[e[h]][g],d.sharedModules=a.sharedModules,d.propertyName=a.propertyName,d.isPrivate=a.isPrivate,d.isFunction=a.isFunction,d.enumerable=a.enumerable,d.writable=a.writable,d.value=a.value,d.prototype=a.prototype);return c};c.inheritProperty=function(a,
b,g){a=a[g];var e=b[g];b=e.sharedModules();var h=Object.keys(b),d,f={propertyName:g,stopPropagation:function(){this._stopPropagation=!0},value:void 0,_stopPropagation:!1,changeOrigin:void 0};f.stopPropagation.bind(f);e.configurable()||a.isFunction()||a.isConstructor()||a.value(e.value());for(e=0;e<h.length;e+=1)d=h[e],void 0!==b[h[e]]&&(a.sharedModules(d,b[d]),d=b[h[e]][g],d.sharedModules=a.sharedModules,d.propertyName=a.propertyName,d.isPrivate=a.isPrivate,d.isFunction=a.isFunction,d.enumerable=
a.enumerable,d.writable=a.writable,d.value=a.value,d.prototype=a.prototype,Object.defineProperty(b[h[e]],g,{enumerable:a.enumerable()}),d.isFunction()||d.isConstructor()||(f.value=a.value(),f.changeOrigin=a.module(),d.isModuleScoped()?d.onChange().call(d.module(),f):d.onChange().call(d.onChange(),f)));return c};c.loadProperties=function(a,b){var g=Object.keys(a),e=b._ModuleLoader.parentModules(),h=Object.keys(e),d,f;for(d=0;d<g.length;d+=1)f=g[d],void 0===b[f]?c.loadProperty(a,b,f):c.inheritProperty(b,
a,f);for(d=0;d<h.length;d+=1)f=e[h[d]],void 0!==f&&c.loadProperties(a,f);return c};c.unloadProperties=function(a,b){var g=b._ModuleLoader.moduleName(),e=a._ModuleLoader.parentModules(),h=Object.keys(e),d=Object.keys(b),f,k;for(f=0;f<d.length;f+=1)k=d[f],a[k].loadedFrom()===g&&(a[k].sharedModules()[a._ModuleLoader.moduleName()]=void 0,delete a[k]);for(f=0;f<h.length;f+=1)k=e[h[f]],void 0!==k&&c.unloadProperties(k,b);return c};c.loadModule=function(a){var b=c.setModule();c.loadProperties(a,b);a._ModuleLoader.parentModules(c.setModuleName(),
b);c.childModules(a._ModuleLoader.moduleName(),a);return c};c.unloadModule=function(a){var b,g,e=c.setModule();"string"===typeof a?(b=a,g=c.childModules()[a]):(g=a,b=a._ModuleLoader.moduleName());void 0!==g&&(c.unloadProperties(e,g),g._ModuleLoader.parentModules()[c.setModuleName()]=void 0,c.childModules()[b]=void 0);return c};c.getLoadGroup=function(a){var b=c.setLoadGroup()[a],g,e;return function(){for(g=0;g<b.length;g+=1)e=c.childModules()[b[g]],void 0!==e&&e.apply(this,arguments)}};void 0!==p&&
c.setModule(p);void 0!==k&&c.setModuleName(k);return c}"function"===typeof define&&define.amd?(define("KM",k),define([],k)):"object"===typeof module&&module.exports&&(module.exports=k);return k}();
